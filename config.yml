recipe: default.v1
assistant_id: 20250630-103937-late-diagonal

language: ko

pipeline:
  # 토큰화
  - name: WhitespaceTokenizer

  # 정규식 특징 (regex 엔티티 추출과 함께 사용)
  - name: RegexFeaturizer

  # ✅ 정규식/lookup 기반 엔티티 추출 (filter_from/filter_to/filter_limit, mode 등)
  - name: RegexEntityExtractor
    case_sensitive: false
    use_lookup_tables: true      # nlu.yml의 lookup: mode 사용
    use_regexes: true            # nlu.yml의 regex: filter_* 사용
    use_word_boundaries: true

  # 품사/형태 기반 특징
  - name: LexicalSyntacticFeaturizer

  # 단어 단위 BoW
  - name: CountVectorsFeaturizer
    analyzer: "word"
    min_ngram: 1
    max_ngram: 1

  # 문자 n-gram (짧은 키워드/오타 보강)
  - name: CountVectorsFeaturizer
    analyzer: "char_wb"
    min_ngram: 1
    max_ngram: 4

  # 인텐트/엔티티 멀티태스킹 분류기
  - name: DIETClassifier
    epochs: 150
    entity_recognition: true
    constrain_similarities: true

  # 동의어 매핑 (mode: 내부→internal, 외부→gemini 등)
  - name: EntitySynonymMapper

  # NLU 폴백 (신뢰도 낮을 때)
  - name: FallbackClassifier
    threshold: 0.3
    ambiguity_threshold: 0.1

policies:
  # 과거 스토리 기억
  - name: MemoizationPolicy

  # 규칙 기반 정책
  - name: RulePolicy
    core_fallback_threshold: 0.3
    core_fallback_action_name: "action_default_fallback"
    enable_fallback_prediction: true

  # 예기치 못한 인텐트 대응
  - name: UnexpecTEDIntentPolicy
    max_history: 5
    epochs: 100

  # 트랜스포머 기반 대화 정책
  - name: TEDPolicy
    max_history: 10
    epochs: 100
    constrain_similarities: true
